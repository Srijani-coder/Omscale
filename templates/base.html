<!DOCTYPE html>
<html>
<head>
    <title>{{ title if title else "Law Firm" }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
<header class="site-header">
    <div class="header-left">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo" class="logo">
        <h1 class="site-name">OmSCALE</h1>
    </div>
    <nav class="header-nav">
        <a href="{{ url_for('home') }}">Home</a>
        <a href="{{ url_for('services') }}">Services</a>
        <a href="{{ url_for('dashboard') }}">Laws & Research Update</a>
    </nav>
    <div class="header-right">
        <span class="phone">üìû +61 0403 338 476</span>
        <button class="contact-btn" onclick="openContact()">Contact</button>
    </div>
</header>

<div id="contact-modal" class="contact-modal">
    <div class="letter-container" id="letter-box">
        <h3>üìú Contact Us</h3>
        <input type="text" id="contact-name" placeholder="Your Name">
        <input type="text" id="contact-info" placeholder="Your Email / Phone">
        <textarea id="contact-message" placeholder="Your Message"></textarea>
        <button class="submit-btn" onclick="submitContact()">Send</button>
    </div>
</div>

<main>
    {% block content %}{% endblock %}
</main>


<footer class="site-footer">
    <div class="footer-left">
        <h3> Main Office</h3>
        <p>68 B, Good Street, Westmead</p>
        <!--  Embed Google Maps -->
        <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d13259.85627815729!2d150.97137615842254!3d-33.813240297259156!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6b12a2dd5afd7767%3A0xa42c211cd90c4f77!2s68B%20Good%20St%2C%20Westmead%20NSW%202145!5e0!3m2!1sen!2sau!4v1754197903224!5m2!1sen!2sau" 
            width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
        </iframe>
        <a href= https://maps.app.goo.gl/zPUBaZqaAJgqUgTn9  target="_blank" class="map-link">
            üìç Get Directions
        </a>
    </div>

    <div class="footer-right">
        <h3>Contact Us</h3>
        <div class="footer-contact">
            <a href="mailto:ombarristersandsolicitors@gmail.com" target="_blank">
                <img src="{{ url_for('static', filename='images/icons/email.svg') }}" alt="Email" class="footer-icon"> ombarristersandsolicitors@gmail.com
            </a>
        </div>
        <div class="footer-contact">
            <a href="https://x.com/OmSCALE_LEGAL" target="_blank">
                <img src="{{ url_for('static', filename='images/icons/twitter.svg') }}" alt="Twitter" class="footer-icon"> @OmSCALE_LEGAL
            </a>
        </div>
        <div class="footer-contact">
            <a href="tel: +61 0403 338 476">
                <img src="{{ url_for('static', filename='images/icons/phone.svg') }}" alt="Phone" class="footer-icon"> +61 0403 338 476
            </a>
        </div>
    </div>
</footer>


<script>
async function openContact() {
    const modal = document.getElementById('contact-modal');
    modal.style.display = 'flex';
}

//  Close modal on outside click ONLY if fields are empty
document.addEventListener('click', function(e) {
    const modal = document.getElementById('contact-modal');
    const letter = document.getElementById('letter-box');
    if (modal.style.display === 'flex' && !letter.contains(e.target) && !e.target.classList.contains('contact-btn')) {
        const name = document.getElementById('contact-name').value.trim();
        const info = document.getElementById('contact-info').value.trim();
        const message = document.getElementById('contact-message').value.trim();
        if (!name && !info && !message) {
            modal.style.display = 'none';
        }
    }
});

async function submitContact() {
    const name = document.getElementById('contact-name').value.trim();
    const info = document.getElementById('contact-info').value.trim();
    const message = document.getElementById('contact-message').value.trim();

    if (!name || !info || !message) {
        alert("Please fill all fields.");
        return;
    }

    const response = await fetch('/send_contact', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({name, info, message})
    });

    const result = await response.json();
    if (result.status === "success") {
        const letter = document.getElementById('letter-box');
        letter.classList.add('closing');

        setTimeout(() => {
            document.getElementById('contact-modal').style.display = 'none';
            letter.classList.remove('closing');
            document.getElementById('contact-name').value = '';
            document.getElementById('contact-info').value = '';
            document.getElementById('contact-message').value = '';
            alert("Message sent successfully!");
        }, 1500);
    } else {
        alert("Failed to send message: " + result.message);
    }
}
</script>


</body>
</html>
